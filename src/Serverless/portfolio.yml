service: LearningPortfolio

# https://www.serverless.com/framework/docs/providers/aws/events/apigateway/#example-lambda-proxy-event-default

#provider: aws
provider:
  name: aws
  runtime: dotnetcore3.1 # nodejs14.x  # explicit to avoid warning
  #stage: test # passed
  #region: eu-central-1
  lambdaHashingVersion: "20201221" # optimize resolution of lambda function (and avoid warning)
  deploymentBucket:
    name: ${file(src/Serverless/shared-variables.yml):deploymentBucket.name}

package:
  individually: true
variables:
  handler_prefix: Learning::Learning.Portfolio

functions:
  CreateFund: # any name
    handler: ${handler_prefix}.CreateFund::Handle   # assembly::namespace.class::method
    package: &package
      artifact: ${file(src/Serverless/shared-variables.yml):zipFile}
    
    #warmup: true
    #alarms:
    #   - functionErrors
    #   - functionDuration
    events:
      # - http: GET fund
      - http: 
          path: learning/portfolio/fund
          method: POST
          cors: true
        #authorizer:
        #  type: "COGNITO_USER_POOLS"
        #  scopes: 
        #    - ...
        #    - ... 
        #  authorizedId:
        #    Fn::ImportValue: "..."
  GetFund:
    handler: ${handler_prefix}.GetFund::Handle   # .Class::Method
    <<: *package   
    events:
      - http: GET learning/portfolio/fund cors
  
  GetFund2:
    handler: ${handler_prefix}.GetFund::Handle   # assembly::namespace.class::method
    <<: *package
    events:
      - http: GET learning/portfolio/fund/{id}


    #<file src="client-data-collection\serverless.yml" target="functions\client-data-collection"/>
    #<file src="Services\ClientDataCollection.Lambda\bin\Release\netcoreapp3.1\clientdatacollectiondomain-deploy-package.zip" target="functions" />
